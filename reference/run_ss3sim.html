<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Master function to run a set of simulations using ss3sim — run_ss3sim • ss3sim</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Master function to run a set of simulations using ss3sim — run_ss3sim"><meta property="og:description" content="This is the main high-level wrapper function used to run
a set of ss3sim simulations.
The data frame passed to simdf is parsed into a list and used to control
ss3sim_base(). Alternatively, you can call ss3sim_base() directly
with your own lists."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ss3sim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.21.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/introduction.html">Introduction to ss3sim</a>
    </li>
    <li>
      <a href="../articles/making-models.html">Creating new ss3sim model setups</a>
    </li>
    <li>
      <a href="../articles/modifying-models.html">Modifying the model included with ss3sim</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ss3sim/ss3sim/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Master function to run a set of simulations using <span class="pkg">ss3sim</span></h1>
    <small class="dont-index">Source: <a href="https://github.com/ss3sim/ss3sim/blob/main/R/run_ss3sim.r" class="external-link"><code>R/run_ss3sim.r</code></a></small>
    <div class="hidden name"><code>run_ss3sim.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This is the main high-level wrapper function used to run
a set of <span class="pkg">ss3sim</span> simulations.
The data frame passed to <code>simdf</code> is parsed into a list and used to control
<code><a href="ss3sim_base.html">ss3sim_base()</a></code>. Alternatively, you can call <code><a href="ss3sim_base.html">ss3sim_base()</a></code> directly
with your own lists.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_ss3sim</span><span class="op">(</span></span>
<span>  <span class="va">iterations</span>,</span>
<span>  simdf <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  parallel_iterations <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-iterations">iterations<a class="anchor" aria-label="anchor" href="#arg-iterations"></a></dt>
<dd><p>A numeric vector specifying which iterations are desired.
For example <code>1:100</code>.
The same number of iterations will be ran for each scenario.
If any iterations already have a folder from a previous run, they will be
skipped even if they do not contain viable results.</p></dd>


<dt id="arg-simdf">simdf<a class="anchor" aria-label="anchor" href="#arg-simdf"></a></dt>
<dd><p>A data frame of instructions with one row per scenario.
See <code><a href="setup_scenarios_defaults.html">setup_scenarios_defaults()</a></code> for default values that will be
used for a generic simulation to get you started.
These default values will only work with the stored cod model because
some of the columns in <code>simdf</code> need to have values that
match the fleet structure of the operating model. If you are not using the
default cod model, please remember to add <code>om_dir</code> and <code>em_dir</code> columns
to <code>simdf</code> with file paths to the locations of your operating model and
estimation method. Essentially, <code>simdf</code> is a way to pass scenario-specific
information to the arguments of <code><a href="ss3sim_base.html">ss3sim_base()</a></code>, whereas the <code>...</code> method
will only work for things like <code>seed</code> that are universal to all scenarios
in a simulation.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>A logical argument that controls whether the scenarios are
run in parallel. You will need to register multiple cores first with a
package such as <span class="pkg">doParallel</span> and have the <span class="pkg">foreach</span> package
installed. For example, the following code will register two cores
and must be called before running <code>run_ss3sim()</code>:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="dv">2</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cl)</span></code></pre><p></p></div></dd>


<dt id="arg-parallel-iterations">parallel_iterations<a class="anchor" aria-label="anchor" href="#arg-parallel-iterations"></a></dt>
<dd><p>A logical argument specifying if you wish to
run iterations in parallel. If you set <code>parallel = TRUE</code> and
<code>parallel_iterations = TRUE</code> then iterations for a given scenario will
be sent to multiple processors. All iterations for a given scenario must
finish before the next scenario is started.
This will be useful if you want to run one scenario fast or if you want
to be able to look at the results for each scenario as they finish in
another instance of <span style="R">R</span>. The argument will be ignored if <code>parallel = FALSE</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Anything else to pass to <code><a href="ss3sim_base.html">ss3sim_base()</a></code>. This could
include <code>bias_adjust</code>. Also, you can pass
additional options to the executable through the argument
<code>extras</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>The output will appear in your current <span style="R">R</span> working directory.
Folders will be named based on the <code>"scenario"</code> column
of <code>simdf</code> or based on the date-time stamp
(i.e., mmddhhmmss) generated automatically at the start of the simulation.
The resulting folders will look like the following if you run
your simulation at noon on January 01:</p><ul><li><p><code>0101120000/1/om</code></p></li>
<li><p><code>0101120000/1/em</code></p></li>
<li><p><code>0101120000/2/om</code></p></li>
<li><p>...</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>The operating model folder, which is passed as a file path
using <code>simdf[["om_dir"]]</code>, should contain the following files:</p><ul><li><p><code>forecast.ss</code>,</p></li>
<li><p><code>yourmodel.ctl</code>,</p></li>
<li><p><code>yourmodel.dat</code>,</p></li>
<li><p><code>ss.par</code>, and</p></li>
<li><p><code>starter.ss</code>.
The files should be the formatted versions that are returned from
Stock Synthesis after the model is optimized, i.e., <code>.ss_new</code> files.
It is important to use these formatted files because many functions in
<span class="pkg">ss3sim</span> and <span class="pkg">r4ss</span> depend on the location of keywords present
in the comments and other standardized formatting. Once you have these
files from a successfully optimized model, rename the <code>.ss_new</code> files
to match the names listed above, though you can change <code>yourmodel</code> to
whatever name is listed for the control and data files in <code>starter.ss</code>.
The estimation model folder should also contain these files, except
<code>ss.par</code> and <code>yourmodel.dat</code> files, which are unnecessary.
See the vignette titled modifying-models for details on modifying an
existing Stock Synthesis model to run with <span class="pkg">ss3sim</span>. Alternatively,
consider modifying the built-in model configuration based on north sea cod.</p></li>
</ul><p>Note that due to the way that Stock Synthesis is being used as an OM,
you may see the following error from ADMB in the console:
Error – base = 0 in function prevariable&amp; pow(const prevariable&amp; v1, CGNU_DOUBLE u)
However, this is not a problem because ADMB is not used to optimize the OM,
and thus, the error can safely be ignored.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="ss3sim_base.html">ss3sim_base()</a></code> can be called directly by passing lists to each
individual argument rather than using the data-frame approach
of <code>run_ss3sim(simdf = )</code>.
The lists correspond to each function called by <code><a href="ss3sim_base.html">ss3sim_base()</a></code>.
Each element is itself a list of arguments for the given function.
Either way allows users to pass arguments to each of the
<code>change_*()</code> or <code>sample_*()</code> functions.
Note that if you do not include an argument,
then <code><a href="ss3sim_base.html">ss3sim_base()</a></code> will assume the value of that argument is <code>NULL</code>.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Sean C. Anderson</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># A run with deterministic process error for model checking</span></span></span>
<span class="r-in"><span><span class="co"># by passing user_recdevs to ss3sim_base through run_ss3sim:</span></span></span>
<span class="r-in"><span><span class="va">recdevs_det</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="fl">101</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="setup_scenarios_defaults.html">setup_scenarios_defaults</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"scenarios"</span> <span class="op">=</span> <span class="st">"determinate"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">run_ss3sim</span><span class="op">(</span></span></span>
<span class="r-in"><span>  iterations <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, simdf <span class="op">=</span> <span class="va">df</span>,</span></span>
<span class="r-in"><span>  bias_adjust <span class="op">=</span> <span class="cn">FALSE</span>, user_recdevs <span class="op">=</span> <span class="va">recdevs_det</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="get_results_all.html">get_results_all</a></span><span class="op">(</span>user_scenarios <span class="op">=</span> <span class="st">"determinate"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ts</span> <span class="op">&lt;-</span> <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"ss3sim_ts.csv"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">expect_equivalent</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">ts</span><span class="op">$</span><span class="va">rec_dev</span><span class="op">[</span><span class="va">ts</span><span class="op">$</span><span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> <span class="op">&amp;</span> <span class="va">ts</span><span class="op">$</span><span class="va">iteration</span> <span class="op">==</span> <span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="va">recdevs_det</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kelli F. Johnson, Sean C. Anderson, Kathryn L. Doering, Cole C. Monnahan, Christine C. Stawitz.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer></div>






  </body></html>

