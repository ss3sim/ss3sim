<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Methods to include time-varying parameters in a Stock Synthesis operating model — change_tv • ss3sim</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Methods to include time-varying parameters in a Stock Synthesis operating model — change_tv"><meta property="og:description" content="change_tv takes Stock Synthesis .ctl, .par, and .dat files
and implements time-varying parameters using environmental variables.
change_tv is specifically set up to work with an operating model
.ctl file."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ss3sim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.21.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/introduction.html">Introduction to ss3sim</a>
    </li>
    <li>
      <a href="../articles/making-models.html">Creating new ss3sim model setups</a>
    </li>
    <li>
      <a href="../articles/modifying-models.html">Modifying the model included with ss3sim</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ss3sim/ss3sim/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Methods to include time-varying parameters in a Stock Synthesis operating model</h1>
    <small class="dont-index">Source: <a href="https://github.com/ss3sim/ss3sim/blob/main/R/change_tv.r" class="external-link"><code>R/change_tv.r</code></a></small>
    <div class="hidden name"><code>change_tv.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>change_tv</code> takes Stock Synthesis <code>.ctl</code>, <code>.par</code>, and <code>.dat</code> files
and implements time-varying parameters using environmental variables.
<code>change_tv</code> is specifically set up to work with an operating model
<code>.ctl</code> file.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">change_tv</span><span class="op">(</span></span>
<span>  <span class="va">change_tv_list</span>,</span>
<span>  ctl_file_in <span class="op">=</span> <span class="st">"control.ss_new"</span>,</span>
<span>  ctl_file_out <span class="op">=</span> <span class="st">"om.ctl"</span>,</span>
<span>  dat_file_in <span class="op">=</span> <span class="st">"ss3.dat"</span>,</span>
<span>  dat_file_out <span class="op">=</span> <span class="st">"ss3.dat"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-change-tv-list">change_tv_list<a class="anchor" aria-label="anchor" href="#arg-change-tv-list"></a></dt>
<dd><p>A list of named vectors. Names correspond to parameters
in the operating model that currently do not use environmental deviations and
the vectors correspond to deviations. See the section
"Specifying the <code>change_tv_list</code>" for help on specifying this argument.</p></dd>


<dt id="arg-ctl-file-in">ctl_file_in<a class="anchor" aria-label="anchor" href="#arg-ctl-file-in"></a></dt>
<dd><p>A string providing the path to the input Stock Synthesis <code>.ctl</code> file.</p></dd>


<dt id="arg-ctl-file-out">ctl_file_out<a class="anchor" aria-label="anchor" href="#arg-ctl-file-out"></a></dt>
<dd><p>A string providing the path to the output Stock Synthesis control file. If the value is <code>NULL</code>, the file will not be written to the disk.</p></dd>


<dt id="arg-dat-file-in">dat_file_in<a class="anchor" aria-label="anchor" href="#arg-dat-file-in"></a></dt>
<dd><p>A string providing the path to the input Stock Synthesis <code>.dat</code> file.</p></dd>


<dt id="arg-dat-file-out">dat_file_out<a class="anchor" aria-label="anchor" href="#arg-dat-file-out"></a></dt>
<dd><p>A string providing the path to the output Stock Synthesis <code>.dat</code> file.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>The function creates modified versions of the  <code>.ctl</code> and
<code>.dat</code> files if ctl_file_out and dat_file_out are not NULL. The function
also returns a list of the modified <code>.ctl</code> and <code>.dat</code> R objects
invisibly.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Although there are three ways to implement time-varying parameters within
Stock Synthesis, <span class="pkg">ss3sim</span> and <code>change_tv</code> only use the environmental variable
option.
Within Stock Synthesis, time-varying parameters work on an annual time-step.
Thus, for models with multiple seasons, the time-varying parameters will
remain constant for the entire year.</p>
<p>The <code>ctl_file_in</code> argument needs to be a <code>.ss_new</code> file because
the documentation in <code>.ss_new</code> files are automated and standardized.
This function takes advantage of the standard documentation the
<code>.ss_new</code> files to determine which lines to manipulate and where to
add code in the <code>.ctl</code>, <code>.par</code>, and <code>.dat</code> files, code that
is necessary to implement time-varying parameters.</p>
<p><span class="pkg">ss3sim</span> uses annual recruitment deviations and may not work with a
model that ties recruitment deviations to environmental covariates. If you
need to compare the environment to annual recruitment deviations, the
preferred option is to transform the environmental variable into an age 0
pre-recruit survey. See page 55 of the Stock Synthesis version 3.24f manual for more
information.</p>
    </div>
    <div id="specifying-the-change-tv-list">
    <h2>Specifying the <code>change_tv_list</code></h2>


<p>Parameters will change to vary with time according to the vectors of
deviations passed to <code>change_tv_list</code>. Vectors of deviations, also
referred to as environmental data, must have a length equal to
<code>endyr-startyr+1</code>, where <code>endyr</code> and <code>startyr</code> are specified the
<code>.dat</code> file. Specify years without deviations as zero.</p>
<p>Parameter names must be unique and match the full parameter name in the
<code>.ctl</code> file. Names for stock recruit parameters must contain "devs",
"R0", or "steep", and only one stock recruit parameter can be time-varying
per model.</p>
<p>This feature will include an <em>additive</em> functional linkage between
environmental data and the parameter where the link parameter is fixed at a
value of one and the par value is specified in the <code>.par</code> file:
\(par'[y] = par + link * env[y]\).</p>
<p>For catchability (\(q\)) the <em>additive</em> functional linkage is implemented
on the log scale: \(ln(q'[y]) = ln(q) + link * env[y]\)</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other change functions:
<code><a href="change_data.html">change_data</a>()</code>,
<code><a href="change_e.html">change_e</a>()</code>,
<code><a href="change_em_binning.html">change_em_binning</a>()</code>,
<code><a href="change_f.html">change_f</a>()</code>,
<code><a href="change_o.html">change_o</a>()</code>,
<code><a href="change_retro.html">change_retro</a>()</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Kotaro Ono, Carey McGilliard, Kelli F. Johnson, and Kathryn L. Doering</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Create a temporary folder for the output and set the working directory:</span></span></span>
<span class="r-in"><span><span class="va">temp_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"ss3sim-tv-example"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">temp_path</span>, showWarnings <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">wd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="va">temp_path</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/on.exit.html" class="external-link">on.exit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="va">wd</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"ss3sim"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">om</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">d</span>, <span class="st">"models"</span>, <span class="st">"cod-om"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="st">"cod-om"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="va">om</span>, <span class="st">"."</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="st">"cod-om"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">change_tv</span><span class="op">(</span></span></span>
<span class="r-in"><span>  change_tv_list <span class="op">=</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="st">"NatM_uniform_Fem_GP_1"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">80</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      <span class="st">"SR_BH_steep"</span> <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>  ctl_file_in <span class="op">=</span> <span class="st">"codOM.ctl"</span>,</span></span>
<span class="r-in"><span>  ctl_file_out <span class="op">=</span> <span class="st">"example.ctl"</span>,</span></span>
<span class="r-in"><span>  dat_file_in <span class="op">=</span> <span class="st">"codOM.dat"</span>,</span></span>
<span class="r-in"><span>  dat_file_out <span class="op">=</span> <span class="st">"example.dat"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Clean up:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"cod-om"</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kelli F. Johnson, Sean C. Anderson, Kathryn L. Doering, Cole C. Monnahan, Christine C. Stawitz.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer></div>






  </body></html>

